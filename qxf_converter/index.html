<!DOCTYPE html>
<html>

    <head>
        <title>QXF to JSON Converter</title>
    </head>

    <body>
        <h1>Convert QXF to JSON</h1>
        <input type='file' id='fileInput' accept='.qxf'>
        <button id='convertButton'>Convert</button>
        <button id='downloadButton' disabled>Download JSON</button>
        <pre id='output'></pre>


        <script src='converter.js'></script>
        <script>
            const fileInput = document.getElementById('fileInput');
            const convertButton = document.getElementById('convertButton');
            const downloadButton = document.getElementById('downloadButton');
            const output = document.getElementById('output');
            let jsonData = null;

            convertButton.addEventListener('click', () => {
                const file = fileInput.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        const xmlData = e.target.result;
                        jsonData = convertQxfToJson(xmlData);
                        if (jsonData) {
                            output.textContent = JSON.stringify(jsonData, null, 2);
                            downloadButton.disabled = false;
                        }
                    };
                    reader.readAsText(file);
                }
            });

            downloadButton.addEventListener('click', () => {
                if (jsonData) {
                    const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(jsonData, null, 2));
                    const downloadAnchorNode = document.createElement('a');
                    downloadAnchorNode.setAttribute("href", dataStr);
                    downloadAnchorNode.setAttribute("download", "fixture.json");
                    document.body.appendChild(downloadAnchorNode); // required for firefox
                    downloadAnchorNode.click();
                    downloadAnchorNode.remove();
                }
            });
        </script>
    </body>

</html>